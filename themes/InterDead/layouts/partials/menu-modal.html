{{- $navigation := .Site.Params.navigation.items | default slice -}}
{{- $currentNavId := "" -}}
{{- if not .IsHome -}}
  {{- with .CurrentSection }}{{ $currentNavId = .Section }}{{ end -}}
  {{- if eq $currentNavId "" }}{{ with .Section }}{{ $currentNavId = . }}{{ end }}{{ end -}}
{{- end -}}
{{- if gt (len $navigation) 0 -}}
<div
  class="gm-modal gm-menuModal"
  data-modal="menu"
  id="gm-menuModal"
  role="dialog"
  aria-modal="true"
  aria-hidden="true"
  aria-labelledby="gm-menuModalTitle"
>
  <div class="gm-modal__dialog gm-ageGate__dialog">
    <div class="gm-modal__header">
      <h2 class="gm-modal__title" id="gm-menuModalTitle">{{ i18n "menu.modal.title" }}</h2>
      <button
        class="gm-modal__close"
        type="button"
        data-modal-close
        aria-label="{{ i18n "menu.modal.close" }}"
      >
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <p class="gm-modal__hint">{{ i18n "menu.modal.hint" }}</p>
    <ul class="gm-modal__options gm-menuModal__options" role="list">
      {{- range $navigation }}
        {{- $id := .id | default "" -}}
        {{- $labelKey := .i18nKey | default .label | default "" -}}
        {{- $label := cond (ne $labelKey "") (i18n $labelKey) "" -}}
        {{- $href := .url | default "" | relLangURL -}}
        {{- $targetId := .targetId | default "" -}}
        {{- $targetAttr := .target | default "" -}}
        {{- $bodyHref := cond (and $.IsHome (ne $targetId "")) (printf "#%s" $targetId) $href -}}
        {{- $disableBody := and (not $.IsHome) (and (ne $id "") (eq $id $currentNavId)) -}}
      <li>
        <div
          class="gm-modal__option gm-menuModal__option{{ if $disableBody }} gm-modal__option--inactive{{ end }}"
          data-menu-option
          data-menu-url="{{ $href }}"
          {{- if $targetId }} data-menu-target="{{ $targetId }}"{{ end }}
          {{- if $disableBody }} aria-disabled="true"{{ end }}
        >
          <a
            class="gm-modal__optionBody"
            href="{{ $bodyHref }}"
            data-menu-option-body
            {{- if $disableBody }} aria-disabled="true" data-menu-body-disabled="true" tabindex="-1"{{ end }}
          >
            <span class="gm-modal__optionLabel">{{ $label }}</span>
          </a>
          {{- if $.IsHome }}
            <a
              class="gm-modal__optionIcon"
              href="{{ $href }}"
              data-menu-option-link
              {{- if $targetAttr }} target="{{ $targetAttr }}"{{ end }}
              aria-label="{{ printf "%s: %s" (i18n "menu.option.open") $label }}"
            >
              â†—
            </a>
          {{- end }}
        </div>
      </li>
      {{- end }}
    </ul>
  </div>
</div>
{{- end -}}
